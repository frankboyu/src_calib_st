/// \file
/// \ingroup tutorial_tree
/// \notebook -nodraw
///  Read data from an ascii file and create a root file with an histogram and an ntuple.
///  See a variant of this macro in basic2.C.
///
/// \macro_code
///
/// \author Rene Brun

#include "Riostream.h"
#include "TCanvas.h"
#include "TCut.h"
TCanvas *PT_can[30];
void SC_PTC_Plot() {

  ifstream in;
  
   in.open("SC_PTC.txt");
   Float_t sector, z, z_err, t, t_err,sigma,sigma_err;
  Int_t nlines = 0;
  std::ofstream SC_PTC;
  SC_PTC.open ("PTC_1DFits.txt", std::ofstream::out);
  auto f = TFile::Open("PTC_NS.root","RECREATE");
  TNtuple ntuple("ntuple","data from ascii file","sector:z:z_err:t:t_err:sigma:sigma_err");
  while (1) {
    in >> sector >> z >> z_err >> t >> t_err >> sigma >> sigma_err;
      if (!in.good()) break;
      if (nlines < 5) printf("sector=%8f, z=%8f, z_err=%8f,t=%8f t_err=%8f sigma=%8f sigma_err=%8f\n",sector,z,z_err,t,t_err,sigma,sigma_err);
      ntuple.Fill(sector,z,z_err,t,t_err,sigma,sigma_err);
      nlines++;
  }
  auto c1 = new TCanvas("c1","c1",600,500);
  c1->Divide(3,2);
  c1->cd(1);
  ntuple.Draw("z:z_err:t:t_err","sector >0  & sector <2 " );
  TGraphErrors *gr = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr->Draw("ap"); //draw graph in current pad
  gr->SetTitle("Sector 1");
  gr->SetMaximum(4.0);
  gr->SetMinimum(0.0);
  TFitResultPtr sec1_r1 = gr->Fit("pol1","S","",10,44);
  double sec1_r1_intcp = sec1_r1->Parameter(0);
  double sec1_r1_slope = sec1_r1->Parameter(1);
  TFitResultPtr sec1_r2 = gr->Fit("pol1","S+","",44,52);
  double sec1_r2_intcp = sec1_r2->Parameter(0);
  double sec1_r2_slope = sec1_r2->Parameter(1);
  TFitResultPtr sec1_r3 = gr->Fit("pol1","S+","",52,60);
  double sec1_r3_intcp = sec1_r3->Parameter(0);
  double sec1_r3_slope = sec1_r3->Parameter(1);
  c1->cd(2);
  ntuple.Draw("z:z_err:t:t_err","sector >1  & sector <3 " );
  TGraphErrors *gr2 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr2->Draw("ap"); //draw graph in current pad
  gr2->SetTitle("Sector 2");
  gr2->SetMaximum(4.0);
  gr2->SetMinimum(0.0);
  TFitResultPtr sec2_r1 = gr2->Fit("pol1","S","",10,44);
  double sec2_r1_intcp = sec2_r1->Parameter(0);
  double sec2_r1_slope = sec2_r1->Parameter(1);
  TFitResultPtr sec2_r2 = gr2->Fit("pol1","S+","",44,52);
  double sec2_r2_intcp = sec2_r2->Parameter(0);
  double sec2_r2_slope = sec2_r2->Parameter(1);
  TFitResultPtr sec2_r3 = gr2->Fit("pol1","S+","",52,60);
  double sec2_r3_intcp = sec2_r3->Parameter(0);
  double sec2_r3_slope = sec2_r3->Parameter(1);
c1->cd(3);
  ntuple.Draw("z:z_err:t:t_err","sector >2  & sector <4 " );
  TGraphErrors *gr3 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr3->Draw("ap"); //draw graph in current pad
  gr3->SetTitle("Sector 3");
  gr3->SetMaximum(4.0);
  gr3->SetMinimum(0.0);
  TFitResultPtr sec3_r1 = gr3->Fit("pol1","S","",10,44);
  double sec3_r1_intcp = sec3_r1->Parameter(0);
  double sec3_r1_slope = sec3_r1->Parameter(1);
  TFitResultPtr sec3_r2 = gr3->Fit("pol1","S+","",44,52);
  double sec3_r2_intcp = sec3_r2->Parameter(0);
  double sec3_r2_slope = sec3_r2->Parameter(1);
  TFitResultPtr sec3_r3 = gr3->Fit("pol1","S+","",52,60);
  double sec3_r3_intcp = sec3_r3->Parameter(0);
  double sec3_r3_slope = sec3_r3->Parameter(1);
  c1->cd(4);
  ntuple.Draw("z:z_err:t:t_err","sector >3  & sector <5 " );
  TGraphErrors *gr4 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr4->Draw("ap"); //draw graph in current pad
  gr4->SetTitle("Sector 4");
  gr4->SetMaximum(4.0);
  gr4->SetMinimum(0.0);
  TFitResultPtr sec4_r1 = gr4->Fit("pol1","S","",10,44);
  double sec4_r1_intcp = sec4_r1->Parameter(0);
  double sec4_r1_slope = sec4_r1->Parameter(1);
  TFitResultPtr sec4_r2 = gr4->Fit("pol1","S+","",44,52);
  double sec4_r2_intcp = sec4_r2->Parameter(0);
  double sec4_r2_slope = sec4_r2->Parameter(1);
  TFitResultPtr sec4_r3 = gr4->Fit("pol1","S+","",52,60);
  double sec4_r3_intcp = sec4_r3->Parameter(0);
  double sec4_r3_slope = sec4_r3->Parameter(1);
  c1->cd(5);
  ntuple.Draw("z:z_err:t:t_err","sector >4  & sector <6 " );
  TGraphErrors *gr5 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr5->Draw("ap"); //draw graph in current pad
  gr5->SetTitle("Sector 5");
  gr5->SetMaximum(4.0);
  gr5->SetMinimum(0.0);
  TFitResultPtr sec5_r1 = gr5->Fit("pol1","S","",10,44);
  double sec5_r1_intcp = sec5_r1->Parameter(0);
  double sec5_r1_slope = sec5_r1->Parameter(1);
  TFitResultPtr sec5_r2 = gr5->Fit("pol1","S+","",44,52);
  double sec5_r2_intcp = sec5_r2->Parameter(0);
  double sec5_r2_slope = sec5_r2->Parameter(1);
  TFitResultPtr sec5_r3 = gr5->Fit("pol1","S+","",52,60);
  double sec5_r3_intcp = sec5_r3->Parameter(0);
  double sec5_r3_slope = sec5_r3->Parameter(1);
  c1->cd(6);
  ntuple.Draw("z:z_err:t:t_err","sector >5  & sector <7 " );
  TGraphErrors *gr6 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr6->Draw("ap"); //draw graph in current pad
  gr6->SetTitle("Sector 6");
  gr6->SetMaximum(4.0);
  gr6->SetMinimum(0.0);
  TFitResultPtr sec6_r1 = gr6->Fit("pol1","S","",10,44);
  double sec6_r1_intcp = sec6_r1->Parameter(0);
  double sec6_r1_slope = sec6_r1->Parameter(1);
  TFitResultPtr sec6_r2 = gr6->Fit("pol1","S+","",44,52);
  double sec6_r2_intcp = sec6_r2->Parameter(0);
  double sec6_r2_slope = sec6_r2->Parameter(1);
  TFitResultPtr sec6_r3 = gr6->Fit("pol1","S+","",52,60);
  double sec6_r3_intcp = sec6_r3->Parameter(0);
  double sec6_r3_slope = sec6_r3->Parameter(1);
  auto c2 = new TCanvas("c2","c2",600,500);
  c2->Divide(3,2);
  c2->cd(1);
  ntuple.Draw("z:z_err:t:t_err","sector >6  & sector <8 " );
  TGraphErrors *gr7 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr7->Draw("ap"); //draw graph in current pad
  gr7->SetTitle("Sector 7");
  gr7->SetMaximum(4.0);
  gr7->SetMinimum(0.0);
  TFitResultPtr sec7_r1 = gr7->Fit("pol1","S","",10,44);
  double sec7_r1_intcp = sec7_r1->Parameter(0);
  double sec7_r1_slope = sec7_r1->Parameter(1);
  TFitResultPtr sec7_r2 = gr7->Fit("pol1","S+","",44,52);
  double sec7_r2_intcp = sec7_r2->Parameter(0);
  double sec7_r2_slope = sec7_r2->Parameter(1);
  TFitResultPtr sec7_r3 = gr7->Fit("pol1","S+","",52,60);
  double sec7_r3_intcp = sec7_r3->Parameter(0);
  double sec7_r3_slope = sec7_r3->Parameter(1);
  c2->cd(2);
  ntuple.Draw("z:z_err:t:t_err","sector >7  & sector <9 " );
  TGraphErrors *gr8 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr8->Draw("ap"); //draw graph in current pad
  gr8->SetTitle("Sector 8");
  gr8->SetMaximum(4.0);
  gr8->SetMinimum(0.);
  TFitResultPtr sec8_r1 = gr8->Fit("pol1","S","",10,44);
  double sec8_r1_intcp = sec8_r1->Parameter(0);
  double sec8_r1_slope = sec8_r1->Parameter(1);
  TFitResultPtr sec8_r2 = gr8->Fit("pol1","S+","",44,52);
  double sec8_r2_intcp = sec8_r2->Parameter(0);
  double sec8_r2_slope = sec8_r2->Parameter(1);
  TFitResultPtr sec8_r3 = gr8->Fit("pol1","S+","",52,60);
  double sec8_r3_intcp = sec8_r3->Parameter(0);
  double sec8_r3_slope = sec8_r3->Parameter(1);
c2->cd(3);
  ntuple.Draw("z:z_err:t:t_err","sector >8  & sector <10 " );
  TGraphErrors *gr9 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr9->Draw("ap"); //draw graph in current pad
  gr9->SetTitle("Sector 9");
  gr9->SetMaximum(4.0);
  gr9->SetMinimum(0.);
  TFitResultPtr sec9_r1 = gr9->Fit("pol1","S","",10,44);
  double sec9_r1_intcp = sec9_r1->Parameter(0);
  double sec9_r1_slope = sec9_r1->Parameter(1);
  TFitResultPtr sec9_r2 = gr9->Fit("pol1","S+","",44,52);
  double sec9_r2_intcp = sec9_r2->Parameter(0);
  double sec9_r2_slope = sec9_r2->Parameter(1);
  TFitResultPtr sec9_r3 = gr9->Fit("pol1","S+","",52,60);
  double sec9_r3_intcp = sec9_r3->Parameter(0);
  double sec9_r3_slope = sec9_r3->Parameter(1);
  
  c2->cd(4);
  ntuple.Draw("z:z_err:t:t_err","sector >9  & sector <11 " );
  TGraphErrors *gr10 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr10->Draw("ap"); //draw graph in current pad
  gr10->SetTitle("Sector 10");
  gr10->SetMaximum(4.0);
  gr10->SetMinimum(0.0);
  TFitResultPtr sec10_r1 = gr10->Fit("pol1","S","",10,44);
  double sec10_r1_intcp = sec10_r1->Parameter(0);
  double sec10_r1_slope = sec10_r1->Parameter(1);
  TFitResultPtr sec10_r2 = gr10->Fit("pol1","S+","",44,52);
  double sec10_r2_intcp = sec10_r2->Parameter(0);
  double sec10_r2_slope = sec10_r2->Parameter(1);
  TFitResultPtr sec10_r3 = gr10->Fit("pol1","S+","",52,60);
  double sec10_r3_intcp = sec10_r3->Parameter(0);
  double sec10_r3_slope = sec10_r3->Parameter(1);
  c2->cd(5);
  ntuple.Draw("z:z_err:t:t_err","sector >10  & sector <12 " );
  TGraphErrors *gr11 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr11->Draw("ap"); //draw graph in current pad
  gr11->SetTitle("Sector 11");
  gr11->SetMaximum(4.0);
  gr11->SetMinimum(0.);
  TFitResultPtr sec11_r1 = gr11->Fit("pol1","S","",10,44);
  double sec11_r1_intcp = sec11_r1->Parameter(0);
  double sec11_r1_slope = sec11_r1->Parameter(1);
  TFitResultPtr sec11_r2 = gr11->Fit("pol1","S+","",44,52);
  double sec11_r2_intcp = sec11_r2->Parameter(0);
  double sec11_r2_slope = sec11_r2->Parameter(1);
  TFitResultPtr sec11_r3 = gr11->Fit("pol1","S+","",52,60);
  double sec11_r3_intcp = sec11_r3->Parameter(0);
  double sec11_r3_slope = sec11_r3->Parameter(1);
  c2->cd(6);
  ntuple.Draw("z:z_err:t:t_err","sector >11  & sector <13 " );
  TGraphErrors *gr12 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr12->Draw("ap"); //draw graph in current pad
  gr12->SetTitle("Sector 12");
  gr12->SetMaximum(4.0);
  gr12->SetMinimum(0.);
  TFitResultPtr sec12_r1 = gr12->Fit("pol1","S","",10,44);
  double sec12_r1_intcp = sec12_r1->Parameter(0);
  double sec12_r1_slope = sec12_r1->Parameter(1);
  TFitResultPtr sec12_r2 = gr12->Fit("pol1","S+","",44,52);
  double sec12_r2_intcp = sec12_r2->Parameter(0);
  double sec12_r2_slope = sec12_r2->Parameter(1);
  TFitResultPtr sec12_r3 = gr12->Fit("pol1","S+","",52,60);
  double sec12_r3_intcp = sec12_r3->Parameter(0);
  double sec12_r3_slope = sec12_r3->Parameter(1);
  auto c3 = new TCanvas("c3","c3",600,500);
  c3->Divide(3,2);
  c3->cd(1);
  ntuple.Draw("z:z_err:t:t_err","sector >12  & sector <14 " );
  TGraphErrors *gr13 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr13->Draw("ap"); //draw graph in current pad
  gr13->SetTitle("Sector 13");
  gr13->SetMaximum(4.0);
  gr13->SetMinimum(0.);
  TFitResultPtr sec13_r1 = gr13->Fit("pol1","S","",10,44);
  double sec13_r1_intcp = sec13_r1->Parameter(0);
  double sec13_r1_slope = sec13_r1->Parameter(1);
  TFitResultPtr sec13_r2 = gr13->Fit("pol1","S+","",44,52);
  double sec13_r2_intcp = sec13_r2->Parameter(0);
  double sec13_r2_slope = sec13_r2->Parameter(1);
  TFitResultPtr sec13_r3 = gr13->Fit("pol1","S+","",52,60);
  double sec13_r3_intcp = sec13_r3->Parameter(0);
  double sec13_r3_slope = sec13_r3->Parameter(1);
  c3->cd(2);
  ntuple.Draw("z:z_err:t:t_err","sector >13  & sector <15 " );
  TGraphErrors *gr14 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr14->Draw("ap"); //draw graph in current pad
  gr14->SetTitle("Sector 14");
  gr14->SetMaximum(4.0);
  gr14->SetMinimum(0.0);
  TFitResultPtr sec14_r1 = gr14->Fit("pol1","S","",10,44);
  double sec14_r1_intcp = sec14_r1->Parameter(0);
  double sec14_r1_slope = sec14_r1->Parameter(1);
  TFitResultPtr sec14_r2 = gr14->Fit("pol1","S+","",44,52);
  double sec14_r2_intcp = sec14_r2->Parameter(0);
  double sec14_r2_slope = sec14_r2->Parameter(1);
  TFitResultPtr sec14_r3 = gr14->Fit("pol1","S+","",52,60);
  double sec14_r3_intcp = sec14_r3->Parameter(0);
  double sec14_r3_slope = sec14_r3->Parameter(1);
c3->cd(3);
  ntuple.Draw("z:z_err:t:t_err","sector >14  & sector <16 " );
  TGraphErrors *gr15 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr15->Draw("ap"); //draw graph in current pad
  gr15->SetTitle("Sector 15");
  gr15->SetMaximum(4.0);
  gr15->SetMinimum(0.0);
  TFitResultPtr sec15_r1 = gr15->Fit("pol1","S","",10,44);
  double sec15_r1_intcp = sec15_r1->Parameter(0);
  double sec15_r1_slope = sec15_r1->Parameter(1);
  TFitResultPtr sec15_r2 = gr15->Fit("pol1","S+","",44,52);
  double sec15_r2_intcp = sec15_r2->Parameter(0);
  double sec15_r2_slope = sec15_r2->Parameter(1);
  TFitResultPtr sec15_r3 = gr15->Fit("pol1","S+","",52,60);
  double sec15_r3_intcp = sec15_r3->Parameter(0);
  double sec15_r3_slope = sec15_r3->Parameter(1);
  c3->cd(4);
  ntuple.Draw("z:z_err:t:t_err","sector >15  & sector <17 " );
  TGraphErrors *gr16 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr16->Draw("ap"); //draw graph in current pad
  gr16->SetTitle("Sector 16");
  gr16->SetMaximum(4.0);
  gr16->SetMinimum(0.0);
  TFitResultPtr sec16_r1 = gr16->Fit("pol1","S","",10,44);
  double sec16_r1_intcp = sec16_r1->Parameter(0);
  double sec16_r1_slope = sec16_r1->Parameter(1);
  TFitResultPtr sec16_r2 = gr16->Fit("pol1","S+","",44,52);
  double sec16_r2_intcp = sec16_r2->Parameter(0);
  double sec16_r2_slope = sec16_r2->Parameter(1);
  TFitResultPtr sec16_r3 = gr16->Fit("pol1","S+","",52,60);
  double sec16_r3_intcp = sec16_r3->Parameter(0);
  double sec16_r3_slope = sec16_r3->Parameter(1);
  c3->cd(5);
  ntuple.Draw("z:z_err:t:t_err","sector >16  & sector <18 " );
  TGraphErrors *gr17 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr17->Draw("ap"); //draw graph in current pad
  gr17->SetTitle("Sector 17");
  gr17->SetMaximum(4.0);
  gr17->SetMinimum(0.);
  TFitResultPtr sec17_r1 = gr17->Fit("pol1","S","",10,44);
  double sec17_r1_intcp = sec17_r1->Parameter(0);
  double sec17_r1_slope = sec17_r1->Parameter(1);
  TFitResultPtr sec17_r2 = gr17->Fit("pol1","S+","",44,52);
  double sec17_r2_intcp = sec17_r2->Parameter(0);
  double sec17_r2_slope = sec17_r2->Parameter(1);
  TFitResultPtr sec17_r3 = gr17->Fit("pol1","S+","",52,60);
  double sec17_r3_intcp = sec17_r3->Parameter(0);
  double sec17_r3_slope = sec17_r3->Parameter(1);
  c3->cd(6);
  ntuple.Draw("z:z_err:t:t_err","sector >17  & sector <19 " );
  TGraphErrors *gr18 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr18->Draw("ap"); //draw graph in current pad
  gr18->SetTitle("Sector 18");
  gr18->SetMaximum(4.0);
  gr18->SetMinimum(0.);
  TFitResultPtr sec18_r1 = gr18->Fit("pol1","S","",10,44);
  double sec18_r1_intcp = sec18_r1->Parameter(0);
  double sec18_r1_slope = sec18_r1->Parameter(1);
  TFitResultPtr sec18_r2 = gr18->Fit("pol1","S+","",44,52);
  double sec18_r2_intcp = sec18_r2->Parameter(0);
  double sec18_r2_slope = sec18_r2->Parameter(1);
  TFitResultPtr sec18_r3 = gr18->Fit("pol1","S+","",52,60);
  double sec18_r3_intcp = sec18_r3->Parameter(0);
  double sec18_r3_slope = sec18_r3->Parameter(1);
  auto c4 = new TCanvas("c4","c4",600,500);
  c4->Divide(3,2);
  c4->cd(1);
  ntuple.Draw("z:z_err:t:t_err","sector >18  & sector <20 " );
  TGraphErrors *gr19 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr19->Draw("ap"); //draw graph in current pad
  gr19->SetTitle("Sector 19");
  gr19->SetMaximum(4.0);
  gr19->SetMinimum(0.);
  TFitResultPtr sec19_r1 = gr19->Fit("pol1","S","",10,44);
  double sec19_r1_intcp = sec19_r1->Parameter(0);
  double sec19_r1_slope = sec19_r1->Parameter(1);
  TFitResultPtr sec19_r2 = gr19->Fit("pol1","S+","",44,52);
  double sec19_r2_intcp = sec19_r2->Parameter(0);
  double sec19_r2_slope = sec19_r2->Parameter(1);
  TFitResultPtr sec19_r3 = gr19->Fit("pol1","S+","",52,60);
  double sec19_r3_intcp = sec19_r3->Parameter(0);
  double sec19_r3_slope = sec19_r3->Parameter(1);
  c4->cd(2);
  ntuple.Draw("z:z_err:t:t_err","sector >19  & sector <21 " );
  TGraphErrors *gr20 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr20->Draw("ap"); //draw graph in current pad
  gr20->SetTitle("Sector 20");
  gr20->SetMaximum(4.0);
  gr20->SetMinimum(0.);
  TFitResultPtr sec20_r1 = gr20->Fit("pol1","S","",10,44);
  double sec20_r1_intcp = sec20_r1->Parameter(0);
  double sec20_r1_slope = sec20_r1->Parameter(1);
  TFitResultPtr sec20_r2 = gr20->Fit("pol1","S+","",44,52);
  double sec20_r2_intcp = sec20_r2->Parameter(0);
  double sec20_r2_slope = sec20_r2->Parameter(1);
  TFitResultPtr sec20_r3 = gr20->Fit("pol1","S+","",52,60);
  double sec20_r3_intcp = sec20_r3->Parameter(0);
  double sec20_r3_slope = sec20_r3->Parameter(1);
c4->cd(3);
  ntuple.Draw("z:z_err:t:t_err","sector >20  & sector <22 " );
  TGraphErrors *gr21 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr21->Draw("ap"); //draw graph in current pad
  gr21->SetTitle("Sector 21");
  gr21->SetMaximum(4.0);
  gr21->SetMinimum(0.);
  TFitResultPtr sec21_r1 = gr21->Fit("pol1","S","",10,44);
  double sec21_r1_intcp = sec21_r1->Parameter(0);
  double sec21_r1_slope = sec21_r1->Parameter(1);
  TFitResultPtr sec21_r2 = gr21->Fit("pol1","S+","",44,52);
  double sec21_r2_intcp = sec21_r2->Parameter(0);
  double sec21_r2_slope = sec21_r2->Parameter(1);
TFitResultPtr sec21_r3 = gr21->Fit("pol1","S+","",52,60);
  double sec21_r3_intcp = sec21_r3->Parameter(0);
  double sec21_r3_slope = sec21_r3->Parameter(1);
  c4->cd(4);
  ntuple.Draw("z:z_err:t:t_err","sector >21  & sector <23 " );
  TGraphErrors *gr22 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr22->Draw("ap"); //draw graph in current pad
  gr22->SetTitle("Sector 22");
  gr22->SetMaximum(4.0);
  gr22->SetMinimum(0.0);
  TFitResultPtr sec22_r1 = gr22->Fit("pol1","S","",10,44);
  double sec22_r1_intcp = sec22_r1->Parameter(0);
  double sec22_r1_slope = sec22_r1->Parameter(1);
  TFitResultPtr sec22_r2 = gr22->Fit("pol1","S+","",44,52);
  double sec22_r2_intcp = sec22_r2->Parameter(0);
  double sec22_r2_slope = sec22_r2->Parameter(1);
  TFitResultPtr sec22_r3 = gr22->Fit("pol1","S+","",52,60);
  double sec22_r3_intcp = sec22_r3->Parameter(0);
  double sec22_r3_slope = sec22_r3->Parameter(1);
  c4->cd(5);
  ntuple.Draw("z:z_err:t:t_err","sector >22  & sector <24 " );
  TGraphErrors *gr23 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr23->Draw("ap"); //draw graph in current pad
  gr23->SetTitle("Sector 23");
  gr23->SetMaximum(4.0);
  gr23->SetMinimum(0.);
  TFitResultPtr sec23_r1 = gr23->Fit("pol1","S","",10,44);
  double sec23_r1_intcp = sec23_r1->Parameter(0);
  double sec23_r1_slope = sec23_r1->Parameter(1);
  TFitResultPtr sec23_r2 = gr23->Fit("pol1","S+","",44,52);
  double sec23_r2_intcp = sec23_r2->Parameter(0);
  double sec23_r2_slope = sec23_r2->Parameter(1);
  TFitResultPtr sec23_r3 = gr23->Fit("pol1","S+","",52,60);
  double sec23_r3_intcp = sec23_r3->Parameter(0);
  double sec23_r3_slope = sec23_r3->Parameter(1);
  c4->cd(6);
  ntuple.Draw("z:z_err:t:t_err","sector >23  & sector <25 " );
  TGraphErrors *gr24 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr24->Draw("ap"); //draw graph in current pad
  gr24->SetTitle("Sector 24");
  gr24->SetMaximum(4.0);
  gr24->SetMinimum(0.);
  TFitResultPtr sec24_r1 = gr24->Fit("pol1","S","",10,44);
  double sec24_r1_intcp = sec24_r1->Parameter(0);
  double sec24_r1_slope = sec24_r1->Parameter(1);
  TFitResultPtr sec24_r2 = gr24->Fit("pol1","S+","",44,52);
  double sec24_r2_intcp = sec24_r2->Parameter(0);
  double sec24_r2_slope = sec24_r2->Parameter(1);
  TFitResultPtr sec24_r3 = gr24->Fit("pol1","S+","",52,60);
  double sec24_r3_intcp = sec24_r3->Parameter(0);
  double sec24_r3_slope = sec24_r3->Parameter(1);
  auto c5 = new TCanvas("c5","c5",600,500);
  c5->Divide(3,2);
  c5->cd(1);
  ntuple.Draw("z:z_err:t:t_err","sector >24  & sector <26 " );
  TGraphErrors *gr25 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr25->Draw("ap"); //draw graph in current pad
  gr25->SetTitle("Sector 25");
  gr25->SetMaximum(4.0);
  gr25->SetMinimum(0.);
  TFitResultPtr sec25_r1 = gr25->Fit("pol1","S","",10,44);
  double sec25_r1_intcp = sec25_r1->Parameter(0);
  double sec25_r1_slope = sec25_r1->Parameter(1);
  TFitResultPtr sec25_r2 = gr25->Fit("pol1","S+","",44,52);
  double sec25_r2_intcp = sec25_r2->Parameter(0);
  double sec25_r2_slope = sec25_r2->Parameter(1);
  TFitResultPtr sec25_r3 = gr25->Fit("pol1","S+","",52,60);
  double sec25_r3_intcp = sec25_r3->Parameter(0);
  double sec25_r3_slope = sec25_r3->Parameter(1);
  c5->cd(2);
  ntuple.Draw("z:z_err:t:t_err","sector >25  & sector <27 " );
  TGraphErrors *gr26 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr26->Draw("ap"); //draw graph in current pad
  gr26->SetTitle("Sector 26");
  gr26->SetMaximum(4.0);
  gr26->SetMinimum(0.);
  TFitResultPtr sec26_r1 = gr26->Fit("pol1","S","",10,44);
  double sec26_r1_intcp = sec26_r1->Parameter(0);
  double sec26_r1_slope = sec26_r1->Parameter(1);
  TFitResultPtr sec26_r2 = gr26->Fit("pol1","S+","",44,52);
  double sec26_r2_intcp = sec26_r2->Parameter(0);
  double sec26_r2_slope = sec26_r2->Parameter(1);
  TFitResultPtr sec26_r3 = gr26->Fit("pol1","S+","",52,60);
  double sec26_r3_intcp = sec26_r3->Parameter(0);
  double sec26_r3_slope = sec26_r3->Parameter(1);
c5->cd(3);
  ntuple.Draw("z:z_err:t:t_err","sector >26  & sector <28 " );
  TGraphErrors *gr27 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr27->Draw("ap"); //draw graph in current pad
  gr27->SetTitle("Sector 27");
  gr27->SetMaximum(4.0);
  gr27->SetMinimum(0.);
  TFitResultPtr sec27_r1 = gr27->Fit("pol1","S","",10,44);
  double sec27_r1_intcp = sec27_r1->Parameter(0);
  double sec27_r1_slope = sec27_r1->Parameter(1);
  TFitResultPtr sec27_r2 = gr27->Fit("pol1","S+","",44,52);
  double sec27_r2_intcp = sec27_r2->Parameter(0);
  double sec27_r2_slope = sec27_r2->Parameter(1);
  TFitResultPtr sec27_r3 = gr27->Fit("pol1","S+","",52,60);
  double sec27_r3_intcp = sec27_r3->Parameter(0);
  double sec27_r3_slope = sec27_r3->Parameter(1);
  c5->cd(4);
  ntuple.Draw("z:z_err:t:t_err","sector >27  & sector <29 " );
  TGraphErrors *gr28 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr28->Draw("ap"); //draw graph in current pad
  gr28->SetTitle("Sector 28");
  gr28->SetMaximum(4.0);
  gr28->SetMinimum(0.0);
  TFitResultPtr sec28_r1 = gr28->Fit("pol1","S","",10,44);
  double sec28_r1_intcp = sec28_r1->Parameter(0);
  double sec28_r1_slope = sec28_r1->Parameter(1);
  TFitResultPtr sec28_r2 = gr28->Fit("pol1","S+","",44,52);
  double sec28_r2_intcp = sec28_r2->Parameter(0);
  double sec28_r2_slope = sec28_r2->Parameter(1);
  TFitResultPtr sec28_r3 = gr28->Fit("pol1","S+","",52,60);
  double sec28_r3_intcp = sec28_r3->Parameter(0);
  double sec28_r3_slope = sec28_r3->Parameter(1);
  c5->cd(5);
  ntuple.Draw("z:z_err:t:t_err","sector >28  & sector <30 " );
  TGraphErrors *gr29 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr29->Draw("ap"); //draw graph in current pad
  gr29->SetTitle("Sector 29");
  gr29->SetMaximum(4.0);
  gr29->SetMinimum(0.);
  TFitResultPtr sec29_r1 = gr29->Fit("pol1","S","",10,44);
  double sec29_r1_intcp = sec29_r1->Parameter(0);
  double sec29_r1_slope = sec29_r1->Parameter(1);
  TFitResultPtr sec29_r2 = gr29->Fit("pol1","S+","",44,52);
  double sec29_r2_intcp = sec29_r2->Parameter(0);
  double sec29_r2_slope = sec29_r2->Parameter(1);
  TFitResultPtr sec29_r3 = gr29->Fit("pol1","S+","",52,60);
  double sec29_r3_intcp = sec29_r3->Parameter(0);
  double sec29_r3_slope = sec29_r3->Parameter(1);
  c5->cd(6);
  ntuple.Draw("z:z_err:t:t_err","sector >29  & sector <31 " );
  TGraphErrors *gr30 = new TGraphErrors(ntuple.GetSelectedRows(), ntuple.GetV1(), ntuple.GetV3(),ntuple.GetV2(), ntuple.GetV4());
  gr30->Draw("ap"); //draw graph in current pad
  gr30->SetTitle("Sector 30");
  gr30->SetMaximum(4.0);
  gr30->SetMinimum(0.);
  TFitResultPtr sec30_r1 = gr30->Fit("pol1","S","",10,44);
  double sec30_r1_intcp = sec30_r1->Parameter(0);
  double sec30_r1_slope = sec30_r1->Parameter(1);
  TFitResultPtr sec30_r2 = gr30->Fit("pol1","S+","",44,52);
  double sec30_r2_intcp = sec30_r2->Parameter(0);
  double sec30_r2_slope = sec30_r2->Parameter(1);
  TFitResultPtr sec30_r3 = gr30->Fit("pol1","S+","",52,60);
  double sec30_r3_intcp = sec30_r3->Parameter(0);
  double sec30_r3_slope = sec30_r3->Parameter(1);
  in.close();
  f->Write();
  SC_PTC << sec1_r1_intcp << "\t"  << sec1_r1_slope << "\t" << sec1_r2_intcp << "\t"  << sec1_r2_slope << "\t"  <<sec1_r3_intcp << "\t"  << sec1_r3_slope <<endl;
  SC_PTC << sec2_r1_intcp << "\t"  << sec2_r1_slope << "\t" << sec2_r2_intcp << "\t"  << sec2_r2_slope << "\t"  <<sec2_r3_intcp << "\t"  << sec2_r3_slope <<endl;
  SC_PTC << sec3_r1_intcp << "\t"  << sec3_r1_slope << "\t" << sec3_r2_intcp << "\t"  << sec3_r2_slope << "\t"  <<sec3_r3_intcp << "\t"  << sec3_r3_slope <<endl;
  SC_PTC << sec4_r1_intcp << "\t"  << sec4_r1_slope << "\t" << sec4_r2_intcp << "\t"  << sec4_r2_slope << "\t"  <<sec4_r3_intcp << "\t"  << sec4_r3_slope <<endl;
  SC_PTC << sec5_r1_intcp << "\t"  << sec5_r1_slope << "\t" << sec5_r2_intcp << "\t"  << sec5_r2_slope << "\t"  <<sec5_r3_intcp << "\t"  << sec5_r3_slope <<endl;
  SC_PTC << sec6_r1_intcp << "\t"  << sec6_r1_slope << "\t" << sec6_r2_intcp << "\t"  << sec6_r2_slope << "\t"  <<sec6_r3_intcp << "\t"  << sec6_r3_slope <<endl;
  SC_PTC << sec7_r1_intcp << "\t"  << sec7_r1_slope << "\t" << sec7_r2_intcp << "\t"  << sec7_r2_slope << "\t"  <<sec7_r3_intcp << "\t"  << sec7_r3_slope <<endl;
  SC_PTC << sec8_r1_intcp << "\t"  << sec8_r1_slope << "\t" << sec8_r2_intcp << "\t"  << sec8_r2_slope << "\t"  <<sec8_r3_intcp << "\t"  << sec8_r3_slope <<endl;
  SC_PTC << sec9_r1_intcp << "\t"  << sec9_r1_slope << "\t" << sec9_r2_intcp << "\t"  << sec9_r2_slope << "\t"  <<sec9_r3_intcp << "\t"  << sec9_r3_slope <<endl;

  SC_PTC << sec10_r1_intcp << "\t"  << sec10_r1_slope << "\t" << sec10_r2_intcp << "\t"  << sec10_r2_slope << "\t"  <<sec10_r3_intcp << "\t"  << sec10_r3_slope <<endl;
  SC_PTC << sec11_r1_intcp << "\t"  << sec11_r1_slope << "\t" << sec11_r2_intcp << "\t"  << sec11_r2_slope << "\t"  <<sec11_r3_intcp << "\t"  << sec11_r3_slope <<endl;
  SC_PTC << sec12_r1_intcp << "\t"  << sec12_r1_slope << "\t" << sec12_r2_intcp << "\t"  << sec12_r2_slope << "\t"  <<sec12_r3_intcp << "\t"  << sec12_r3_slope <<endl;
  SC_PTC << sec13_r1_intcp << "\t"  << sec13_r1_slope << "\t" << sec13_r2_intcp << "\t"  << sec13_r2_slope << "\t"  <<sec13_r3_intcp << "\t"  << sec13_r3_slope << endl;
  SC_PTC << sec14_r1_intcp << "\t"  << sec14_r1_slope << "\t" << sec14_r2_intcp << "\t"  << sec14_r2_slope << "\t"  <<sec14_r3_intcp << "\t"  << sec14_r3_slope <<endl;
  SC_PTC << sec15_r1_intcp << "\t"  << sec15_r1_slope << "\t" << sec15_r2_intcp << "\t"  << sec15_r2_slope << "\t"  <<sec15_r3_intcp << "\t"  << sec15_r3_slope<<endl;
  SC_PTC << sec16_r1_intcp << "\t"  << sec16_r1_slope << "\t" << sec16_r2_intcp << "\t"  << sec16_r2_slope << "\t"  <<sec16_r3_intcp << "\t"  << sec16_r3_slope<<endl;
  SC_PTC << sec17_r1_intcp << "\t"  << sec17_r1_slope << "\t" << sec17_r2_intcp << "\t"  << sec17_r2_slope << "\t"  <<sec17_r3_intcp << "\t"  << sec17_r3_slope<<endl;
  SC_PTC << sec18_r1_intcp << "\t"  << sec18_r1_slope << "\t" << sec18_r2_intcp << "\t"  << sec18_r2_slope << "\t"  <<sec18_r3_intcp << "\t"  << sec18_r3_slope<<endl;
  SC_PTC << sec19_r1_intcp << "\t"  << sec19_r1_slope << "\t" << sec19_r2_intcp << "\t"  << sec19_r2_slope << "\t"  <<sec19_r3_intcp << "\t"  << sec19_r3_slope<<endl;
  SC_PTC << sec20_r1_intcp << "\t"  << sec20_r1_slope << "\t" << sec20_r2_intcp << "\t"  << sec20_r2_slope << "\t"  <<sec20_r3_intcp << "\t"  << sec20_r3_slope<<endl;
  SC_PTC << sec21_r1_intcp << "\t"  << sec21_r1_slope << "\t" << sec21_r2_intcp << "\t"  << sec21_r2_slope << "\t"  <<sec21_r3_intcp << "\t"  << sec21_r3_slope<<endl;
  SC_PTC << sec22_r1_intcp << "\t"  << sec22_r1_slope << "\t" << sec22_r2_intcp << "\t"  << sec22_r2_slope << "\t"  <<sec22_r3_intcp << "\t"  << sec22_r3_slope<<endl;
  SC_PTC << sec23_r1_intcp << "\t"  << sec23_r1_slope << "\t" << sec23_r2_intcp << "\t"  << sec23_r2_slope << "\t"  <<sec23_r3_intcp << "\t"  << sec23_r3_slope<<endl;
  SC_PTC << sec24_r1_intcp << "\t"  << sec24_r1_slope << "\t" << sec24_r2_intcp << "\t"  << sec24_r2_slope << "\t"  <<sec24_r3_intcp << "\t"  << sec24_r3_slope<<endl;
  SC_PTC << sec25_r1_intcp << "\t"  << sec25_r1_slope << "\t" << sec25_r2_intcp << "\t"  << sec25_r2_slope << "\t"  <<sec25_r3_intcp << "\t"  << sec25_r3_slope<<endl;
  SC_PTC << sec26_r1_intcp << "\t"  << sec26_r1_slope << "\t" << sec26_r2_intcp << "\t"  << sec26_r2_slope << "\t"  <<sec26_r3_intcp << "\t"  << sec26_r3_slope<<endl;
  SC_PTC << sec27_r1_intcp << "\t"  << sec27_r1_slope << "\t" << sec27_r2_intcp << "\t"  << sec27_r2_slope << "\t"  <<sec27_r3_intcp << "\t"  << sec27_r3_slope<<endl;
  SC_PTC << sec28_r1_intcp << "\t"  << sec28_r1_slope << "\t" << sec28_r2_intcp << "\t"  << sec28_r2_slope << "\t"  <<sec28_r3_intcp << "\t"  << sec28_r3_slope<<endl;
  SC_PTC << sec29_r1_intcp << "\t"  << sec29_r1_slope << "\t" << sec29_r2_intcp << "\t"  << sec29_r2_slope << "\t"  <<sec29_r3_intcp << "\t"  << sec29_r3_slope<<endl;
  SC_PTC << sec30_r1_intcp << "\t"  << sec30_r1_slope << "\t" << sec30_r2_intcp << "\t"  << sec30_r2_slope << "\t"  <<sec30_r3_intcp << "\t"  << sec30_r3_slope<<endl;
  SC_PTC.close();
}
